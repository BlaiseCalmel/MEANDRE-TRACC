<!DOCTYPE html>
<html lang="fr">
    <head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Abigail</title>

	<!-- Google Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway+Dots&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
	      rel="stylesheet">


	<!-- topojson for json -->
	<script src="//d3js.org/topojson.v1.min.js"></script>
	<!-- geotoolbox for geo transformation -->
	<script src="https://cdn.jsdelivr.net/npm/geotoolbox" charset="utf-8"></script>

	<!-- d3 -->
	<script src="https://d3js.org/d3.v6.min.js"></script>
	<!-- d3 interpolate path -->
	<script src="https://unpkg.com/d3-interpolate-path@2.3.0/build/d3-interpolate-path.js"></script>

	<!-- jQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
	
	<!-- Slider -->
	<link href="src/nouislider.css" rel="stylesheet">
	<script src="src/nouislider.js"></script>

	<script src="src/wNumb.js"></script>
	
	
	<style>

	 /* font-family: 'Lato', sans-serif;
	    font-family: 'Poppins', sans-serif;
	    font-family: 'Raleway', sans-serif;
	    font-family: 'Raleway Dots', sans-serif; */
	 
         body {
             margin: 0;
             padding: 0;
             display: flex;
             height: 100vh;
             overflow: hidden;
	     background-color: #F5F5F5;
	     color: #060508;
	     font-family: "Lato", sans-serif;
	     font-size: 0.9rem;
         }

	 .menu_section,
	 .menu_section-slider {
	     font-family: "Raleway", sans-serif;
	     font-weight:400;
	     font-size: 1.3rem;
	     margin-top: 1.5rem;
	     margin-bottom: 0.3rem;
	 }
	 .menu_section-slider {
	     margin-top: 1.5rem;
	     margin-bottom: 0.8rem;
	 }

         #menu {
	     pointer-events: auto;
             width: 10px;
             background-color: #ffffff;
             /* color: #CDD2D6; */
	     color: #060508;
             padding-top: 25px;
	     padding-bottom: 10px;
	     padding-left: 10px;
	     padding-right: 10px;
             /* box-shadow: 2px 0px 5px #22222280; */
             transition: width 0.3s ease;
             position: absolute;
             top: 0;
             bottom: 0;
             z-index: 2;
	     overflow-y: auto;
	     scrollbar-width: none; /* For Firefox */
         }
	 #menu::-webkit-scrollbar {
	     display: none; /* Hide scrollbar for Chrome, Safari, and Opera */
	 }
         #menu.expanded {
	     pointer-events: auto;
             width: 250px;
         }

         .hidden {
             display: none;
         }

         #menu-button {
             cursor: pointer;
             z-index: 3;
             position: absolute;
             top: 10px;
             left: 10px;
         }

	 a {
	     color: #060508;
	     text-decoration: none;
	 }
	 



	 .bunch {
	     display: flex;
	     flex-direction: row;
	     flex-wrap: wrap;
	     align-items: baseline;
	     margin: -1px;
	 }
	 
	 button {
	     font: inherit;
	     border: none;
	     min-width: 2rem;
	     padding: 0 0.4rem;
	     margin: 0;
	     background-color: transparent;
	     cursor: pointer;
	     color: #89898a;
	     touch-action: manipulation;
	     position: relative;
	     
	     /* display: inline-block; */
	     display: inline-flex;
	     flex-direction: row;
	     flex-wrap: nowrap;
	     /* margin: -1px; */
	     align-items: center;

	     
	 }
	 button.selected {
	     color: #060508;
	     font-weight: bold;
	     /* padding: 0 0.4rem; */
	 }
	 button:hover,
	 a:focus,
	 a:hover {
	     font-weight: normal;
	     color: #060508;
	     /* padding: 0 0.4rem; */
	 }

	 button.selected .notif,
	 button:hover .notif {
	     position: absolute;
	     top: 0.25rem;
	     right: -0.05rem;
	     transform: translateY(-50%);
	     height: 0.6rem;
	     width: 0.6rem;
	     border-radius: 1rem/1rem;
	     background: red;
	     border: solid 2px #ffffff;
	     color: white;
	     display: inline-block;
	 }

	 .material-icons {
	     color: #302f2f;
	 }

	 .material-icons.inline {
	     font-size: 0.9rem;
	     margin-right: 0.2rem;
	 }

	 
	 button .material-icons {
	     color: #89898a;
	 }
	 button.selected .material-icons {
	     color: #060508;
	     font-weight: bold;
	 }
	 button:hover .material-icons {
	     color: #060508;
	     font-weight: normal;
	 }

	 
	 .RCP26 {
	     &.selected .notif {
		 background: #0B56A4;
	     }
	     &:hover .notif .notif {
		 background: #0B56A495;
	     }
	 }
	 .RCP45 {
	     &.selected .notif {
		 background: #DE8E0D;
	     }
	     &:hover .notif {
		 background: #DE8E0D95;
	     }
	 }
	 .RCP85 {
	     &.selected .notif {
		 background: #DA2516;
	     }
	     &:hover .notif {
		 background: #DA251695;
	     }
	 }

	 .EUPHORBE {
	     &.selected .notif {
		 background: #447C57;
	     }
	     &:hover .notif {
		 background: #447C5795;
	     }
	 }
	 .NARCISSE {
	     &.selected .notif {
		 background: #E5E840;
	     }
	     &:hover .notif {
		 background: #E5E84095;
	     }
	 }
	 .DAHLIA {
	     &.selected .notif {
		 background: #E2A13B;
	     }
	     &:hover .notif {
		 background: #E2A13B95;
	     }
	 }
	 .ASTER {
	     &.selected .notif {
		 background: #70194E;
	     }
	     &:hover .notif {
		 background: #70194E95;
	     }
	 }
	 .ASTER_EUPHORBE {
	     &.selected .notif {
		 background: transparent;
		 background-image: linear-gradient(-45deg, #70194E 50%, #447C57 0%);
	     }
	     &:hover .notif {
		 background: transparent;
		 background-image: linear-gradient(-45deg, #70194E95 50%, #447C5795 0%);
	     }
	 }

	 .ASTER_DAHLIA_NARCISSE_EUPHORBE {
	     &.selected .notif {
		 background-image: linear-gradient(-45deg, #70194E 25%, #E2A13B 25% 50%, #E5E840 50% 75%, #447C57 75%);
	     }
	     &:hover .notif {
		 background-image: linear-gradient(-45deg, #70194E95 25%, #E2A13B95 25% 50%, #E5E84095 50% 75%, #447C5795 75%);
	     }
	 }
	 
	 
	 .CTRIP {
	     &.selected .notif {
		 background: #A88D72;
	     }
	     &:hover .notif {
		 background: #A88D7295;
	     }
	 }
	 .EROS {
	     &.selected .notif {
		 background: #CECD8D;
	     }
	     &:hover .notif {
		 background: #CECD8D95;
	     }
	 }
	 .GRSD {
	     &.selected .notif {
		 background: #619C6C;
	     }
	     &:hover .notif {
		 background: #619C6C95;
	     }
	 }
	 .J2000 {
	     &.selected .notif {
		 background: #00a3a6;
	     }
	     &:hover .notif {
		 background: #00a3a695;
	     }
	 }
	 .MORDOR-SD {
	     &.selected .notif {
		 background: #D8714E;
	     }
	     &:hover .notif {
		 background: #D8714E95;
	     }
	 }
	 .MORDOR-TS {
	     &.selected .notif {
		 background: #AE473E;
	     }
	     &:hover .notif {
		 background: #AE473E95;
	     }
	 }
	 .ORCHIDEE {
	     &.selected .notif {
		 background: #EFA59D;
	     }
	     &:hover .notif {
		 background: #EFA59D95;
	     }
	 }
	 .SIM2 {
	     &.selected .notif {
		 background: #475E6A;
	     }
	     &:hover .notif {
		 background: #475E6A95;
	     }
	 }
	 .SMASH {
	     &.selected .notif {
		 background: #F6BA62;
	     }
	     &:hover .notif {
		 background: #F6BA6295;
	     }
	 }
	 
	 

	 


	 
	 

	 #range-container {
	     margin-right: 15px;
	     margin-left: 15px;
	     margin-bottom: -0.5rem;
	     top: 23px;
	     height: 50px;
	     position: relative;
         }


	 .slider-styled,
	 .slider-styled .noUi-handle {
	     box-shadow: none;
	 }

	 /* Hide markers on slider handles */
	 .slider-styled .noUi-handle::before,
	 .slider-styled .noUi-handle::after {
	     display: none;
	 }

	 .slider-round {
	     height: 5px;
	     border: 0px solid transparent;
	 }

	 .slider-round .noUi-connect {
	     background: #3d3e3e;
	 }

	 .slider-round .noUi-base {
	     background: #CACCCC;
	     border-radius: 5px;
	     border: 0px solid transparent;
	 }

	 .slider-round .noUi-handle {
	     height: 16px;
	     width: 16px;
	     top: -6px;
	     right: -8px; /* half the width */
	     border-radius: 50%;
	     background: #3d3e3e;
	     border: 0px solid transparent;
	 }
	 .slider-round .noUi-handle:hover {
	     height: 18px;
	     width: 18px;
	     top: -7px;
	     right: -9px; /* half the width */
	     border-radius: 50%;
	     background: #3d3e3e;
	     border: 0px solid transparent;
	 }
	 .slider-round .noUi-handle:active {
	     height: 26px;
	     width: 26px;
	     top: -11px;
	     right: -13px; /* half the width */
	     border-radius: 50%;
	     background: #3d3e3e;
	     border: 5px solid #3d3e3e80;
	     border: 5px solid #3d3e3e80;
	     -webkit-background-clip: padding-box; /* for Safari */
	     background-clip: padding-box; /* for IE9+, Firefox 4+, Opera, Chrome */
	 }

	 .slider-round .noUi-tooltip {
	     display: block;
	     position: absolute;
	     border-radius: 6px;
	     background: #ffffff;
	     color: #060508;
	     padding-top: 1px;
	     padding-bottom: 1px;
	     padding-left: 3px;
	     padding-right: 3px;
	     text-align: center;
	     white-space: nowrap;
	     border: 0;
	     box-shadow: 0 1px 2px rgba(60,64,67,0.3),0 1px 3px 1px rgba(60,64,67,0.15);
	 }

	 .slider-round .noUi-tooltip::before {
	     content: "";
	     display: block;
	     background: #ffffff;
	     border-radius: 3px;
	     bottom: -5px;
	     height: 12px;
	     position: absolute;
	     transform: translateX(-50%) rotate(45deg);
	     width: 12px;
	     left: 50%;
	     border: 0;
	 }
	 
	 .slider-round .noUi-tooltip-arrow {
	     content: "";
	     display: block;
	     background: transparent;
	     border-radius: 3px;
	     bottom: 5px;
	     height: 12px;
	     position: absolute;
	     transform: translateX(50%) rotate(45deg);
	     width: 12px;
	     border: 0;
	     box-shadow: 0 1px 2px rgba(60,64,67,0.3),0 2px 4px 2px rgba(60,64,67,0.15);
	 }

	 .slider-round .noUi-marker {
	     position: absolute;
	     background: #CCC;
	 }
	 .slider-round .noUi-marker-sub {
	     background: #AAA;
	 }
	 .slider-round .noUi-marker-large {
	     background: #AAA;
	 }

	 .slider-round .noUi-pips-horizontal {
	     padding: 10px 0;
	     height: 80px;
	     top: 100%;
	     left: 0;
	     width: 100%;
	 }
	 .slider-round .noUi-value-horizontal {
	     -webkit-transform: translate(-50%, 50%);
	     transform: translate(-50%, 50%);
	 }
	 .slider-round .noUi-rtl .noUi-value-horizontal {
	     -webkit-transform: translate(50%, 50%);
	     transform: translate(50%, 50%);
	 }
	 .slider-round .noUi-marker-horizontal.noUi-marker {
	     margin-left: -1px;
	     width: 1px;
	     height: 7px;
	 }
	 .slider-round .noUi-marker-horizontal.noUi-marker-sub {
	     height: 7px;
	     width: 1px;
	 }
	 .slider-round .noUi-marker-horizontal.noUi-marker-large {
	     height: 10px;
	     width: 2px;
	 }


	 #back_bar_map_gallery {
	     display: flex;
	     flex-direction: row;
	     flex-wrap: wrap;
	     align-content: stretch;
	     padding: 0rem;
	 }

	 #back_bar {
	     background-color: transparent;
	     display: flex;
	     flex-direction: row;
	     flex-wrap: wrap;
	     align-content: stretch;
	     width: 100vw; 
	     overflow-x: auto;
	     padding: 0rem;
	     margin-left: 35px;
	     scrollbar-width: none; /* For Firefox */
	 }
	 #back-bar::-webkit-scrollbar {
	     display: none; /* Hide scrollbar for Chrome, Safari, and Opera */
	 }

	 #back_map_gallery {
	     display: flex;
	     flex-direction: row;
	     flex-wrap: wrap;
	     align-content: stretch;
	     width: 100vw; 
	     height: 100vh;
	     overflow-y: auto;
	     padding: 0rem;
	 }
	 

	 
	 #bar {
	     background-color: transparent;
	     height: 52px;
	     top: 0px;
	     width: 2000px;
	     z-index: 1;
	 }
	 
	 #gallery-bar {
	     background-color: transparent;
	     display: flex;
	     overflow-x: auto;
	     white-space: nowrap;
	 }

	 
	 .gallery-bar-item {
	     position: relative;
	     padding: 1ch 1rem;
	     overflow: hidden;
	 }

	 .button_bar {
	     font: inherit;
	     border: 2px solid transparent;
	     border-radius: 0.5rem/0.5rem;
	     width: auto;
	     padding: 0 0.5rem;
	     margin: -1px;
	     background-color: #ffffff;
	     cursor: pointer;
	     color: #060508;
	     touch-action: manipulation;
	 }
	 .button_bar.selected {
	     color: #89898a;
	     border: 2px solid #89898a;
	 }
	 .button_bar:hover {
	     color: #89898a;
	 }

	 


	 #map-container {
	     width: calc(100vh);
	     height: calc(100vh);
	     top: 0px;
	     left: 30px;
	     position: fixed;
	     overflow: hidden;
         }

	 
	 .gallery {
	     display: grid;
	     grid-template-rows: repeat(auto-fill, minmax(15vw, 1fr));
	     grid-template-columns: repeat(auto-fill, minmax(15vw, 1fr));
	     grid-gap: 1rem;
	     grid-auto-flow: dense;
	     width: calc(100vw - 100vh - 1rem - 30px);
	     height: 2000px;
	     margin-left: calc(100vh + 30px);
	     overflow-y: auto;
	     padding-left: 1rem;
	     padding-right: 1rem;
	 }
	 .horizontal {
	     grid-column: span 2;
	 }
	 .vertical {
	     grid-row: span 2;
	 }


	 .gallery-item {
	     border: 3px solid #ffffff;
	     background-color: #ffffff;
	     padding: 1ch 1rem;
	     position: relative;
	     overflow: hidden;
	     border-radius: 10px;
	 }

	 .gallery-item img {
	     position: absolute;
	     top: 50%;
	     left: 50%;
	     transform: translate(-50%, -50%);
	 }

	 .gallery-item span {
	     position: relative;
	     z-index: 1;
	     color: #060508;
	 }


	 
	 @media (max-width: 768px) {
	     /* #back { */
	     /* flex-direction: column; */
	     /* align-items: stretch; */
	     /* }  */

	     #map-container {
		 position: relative;
		 width: 100vw;
		 height: 100vw;
	     }

	     .gallery {
		 width: 100vw;
		 margin-left: 20px;
		 top: 100vw;
	     }
	 }


	</style>
    </head>
    <body>
	<div id="menu-button" onclick="toggleMenu()" style="color:white">M</div>
	

        <div id="menu">
            <div id="menuExpand" class="hidden">
		
		<p class="menu_section-slider">Période de référence</p>
		<div id="range-container">
		    <div id="period_reference" class="slider-styled slider-round"></div>
		</div></br>
		
		<p class="menu_section-slider">Période futur</p>
		<div id="range-container">
		    <div id="period_futur" class="slider-styled slider-round"></div>
		</div></br>

		<p class="menu_section">Scénario Climatique</p>
		<div id="bunch_RCP" class="bunch">
		    <button id="26_GCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>RCP 2.6</span>
		    </button>
		    <button id="45_GCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>RCP 4.5</span>
		    </button>
		    <button id="85_GCM" class="selected" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>RCP 8.5</span>
		    </button>
		</div>

		<p class="menu_section">Global Climate Model</p>
		<div id="bunch_26_GCM" class="bunch" style="display: none;">
		    <button id="26_CNRM-CM5_RCM" class="selected" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>CNRM-CM5</span>
		    </button>
		    <button id="26_EC-EARTH_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>EC-EARTH</span>
		    </button>
		    <button id="26_HadGEM2-ES_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>HadGEM2-ES</span>
		    </button>
		    <button id="26_MPI-ESM-LR_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>MPI-ESM-LR</span>
		    </button>
		    <button id="26_NorESM1-M_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>NorESM1-M</span>
		    </button>
		</div>

		<div id="bunch_45_GCM" class="bunch" style="display: none;">
		    <button id="45_CNRM-CM5_RCM" class="selected" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>CNRM-CM5</span>
		    </button>
		    <button id="45_EC-EARTH_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>EC-EARTH</span>
		    </button>
		    <button id="45_HadGEM2-ES_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>HadGEM2-ES</span>
		    </button>
		    <button id="45_IPSL-CM5A-MR_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>IPSL-CM5A-MR</span>
		    </button>
		    <button id="45_MPI-ESM-LR_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>MPI-ESM-LR</span>
		    </button>
		    <button id="45_NorESM1-M_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>NorESM1-M</span>
		    </button>
		</div>

		<div id="bunch_85_GCM" class="bunch" style="display: block;">
		    <button id="85_CNRM-CM5_RCM" class="NARCISSE selected" onclick="selectButton(this); show_GCM_RCM(this);">
			<span class="material-icons inline">filter_drama </span>
			<span>CNRM-CM5</span>
			<span class="notif"></span>
		    </button>
		    <button id="85_EC-EARTH_RCM" class="DAHLIA" onclick="selectButton(this); show_GCM_RCM(this);">
			<!-- <span class="material-icons inline">wb_sunny</span> -->
			<span>EC-EARTH</span>
			<span class="notif"></span>
		    </button>
		    <button id="85_HadGEM2-ES_RCM" class="ASTER_EUPHORBE" onclick="selectButton(this); show_GCM_RCM(this);">
			<!-- <span class="material-icons inline">umbrella local_fire_department </span> -->
			<span>HadGEM2-ES</span>
			<span class="notif"></span>
		    </button>
		    <button id="85_IPSL-CM5A-MR_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>IPSL-CM5A-MR</span>
		    </button>
		    <button id="85_MPI-ESM-LR_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>MPI-ESM-LR</span>
		    </button>
		    <button id="85_NorESM1-M_RCM" onclick="selectButton(this); show_GCM_RCM(this);">
			<span>NorESM1-M</span>
		    </button>
		</div>



		<p class="menu_section">Regional Climate Model</p>
		<!-- CNRM-CM5 -->
		<div id="bunch_26_CNRM-CM5_RCM" class="bunch" style="display: none;">
		    <button id="26_CNRM-CM5_ALADIN63" class="selected" onclick="selectButton(this)">
			<span>ALADIN63</span>
		    </button>
		    <button id="26_CNRM-CM5_RACMO22E" onclick="selectButton(this)">
			<span>RACMO22E</span>
		    </button>
		</div>
		<div id="bunch_45_CNRM-CM5_RCM" class="bunch" style="display: none;">
		    <button id="45_CNRM-CM5_ALADIN63" class="selected" onclick="selectButton(this)">
			<span>ALADIN63</span>
		    </button>
		    <button id="45_CNRM-CM5_RACMO22E" onclick="selectButton(this)">
			<span>RACMO22E</span>
		    </button>
		</div>
		<div id="bunch_85_CNRM-CM5_RCM" class="bunch">
		    <button id="85_CNRM-CM5_ALADIN63" class="NARCISSE selected" onclick="selectButton(this)">
			<span>ALADIN63</span>
			<span class="notif"></span>
		    </button>
		    <button id="85_CNRM-CM5_RACMO22E" onclick="selectButton(this)">
			<span>RACMO22E</span>
		    </button>
		    <button id="85_CNRM-CM5_HadREM3-GA7" onclick="selectButton(this)">
			<span>HadREM3-GA7</span>
		    </button>
		</div>

		<!-- EC-EARTH -->
		<div id="bunch_26_EC-EARTH_RCM" class="bunch" style="display: none;">
		    <button id="26_EC-EARTH_RACMO22E" class="selected" onclick="selectButton(this)">
			<span>RACMO22E</span>
		    </button>
		    <button id="26_EC-EARTH_RCA4" onclick="selectButton(this)">
			<span>RCA4</span>
		    </button>
		    <button id="26_EC-EARTH_HadREM3-GA7" onclick="selectButton(this)">
			<span>HadREM3-GA7</span>
		    </button>
		</div>
		<div id="bunch_45_EC-EARTH_RCM" class="bunch" style="display: none;">
		    <button id="45_EC-EARTH_RACMO22E" class="selected" onclick="selectButton(this)">
			<span>RACMO22E</span>
		    </button>
		    <button id="45_EC-EARTH_RCA4" onclick="selectButton(this)">
			<span>RCA4</span>
		    </button>
		</div>
		<div id="bunch_85_EC-EARTH_RCM" class="bunch" style="display: none;">
		    <button id="85_EC-EARTH_RACMO22E" onclick="selectButton(this)">
			<span>RACMO22E</span>
		    </button>
		    <button id="85_EC-EARTH_RCA4" onclick="selectButton(this)">
			<span>RCA4</span>
		    </button>
		    <button id="85_EC-EARTH_HadREM3-GA7" class="DAHLIA selected" onclick="selectButton(this)">
			<span>HadREM3-GA7</span>
			<span class="notif"></span>
		    </button>
		</div>

		<!-- HadGEM2-ES -->
		<div id="bunch_26_HadGEM2-ES_RCM" class="bunch" style="display: none;">
		    <button id="26_HadGEM2-ES_RegCM4-6" class="selected" onclick="selectButton(this)">
			<span>RegCM4-6</span>
		    </button>
		    <button id="26_HadGEM2-ES_HadREM3-GA7" onclick="selectButton(this)">
			<span>HadREM3-GA7</span>
		    </button>
		</div>
		<div id="bunch_45_HadGEM2-ES_RCM" class="bunch" style="display: none;">
		    <button id="45_HadGEM2-ES_CCLM4-8-17" class="selected" onclick="selectButton(this)">
			<span>CCLM4-8-17</span>
		    </button>
		</div>
		<div id="bunch_85_HadGEM2-ES_RCM" class="bunch" style="display: none;">
		    <button id="85_HadGEM2-ES_ALADIN63" class="EUPHORBE" onclick="selectButton(this)">
			<span>ALADIN63</span>
			<span class="notif"></span>
		    </button>
		    <button id="85_HadGEM2-ES_CCLM4-8-17" class="ASTER selected" onclick="selectButton(this)">
			<span>CCLM4-8-17</span>
			<span class="notif"></span>
		    </button>
		    <button id="85_HadGEM2-ES_RegCM4-6" onclick="selectButton(this)">
			<span>RegCM4-6</span>
		    </button>
		    <button id="85_HadGEM2-ES_HadREM3-GA7" onclick="selectButton(this)">
			<span>HadREM3-GA7</span>
		    </button>
		</div>
		
		<!-- IPSL-CM5A-MR -->
		<div id="bunch_45_IPSL-CM5A-MR_RCM" class="bunch" style="display: none;">
		    <button id="45_IPSL-CM5A-MR_RCA4" class="selected" onclick="selectButton(this)">
			<span>RCA4</span>
		    </button>
		    <button id="45_IPSL-CM5A-MR_WRF381P" onclick="selectButton(this)">
			<span>WRF381P</span>
		    </button>
		</div>
		<div id="bunch_85_IPSL-CM5A-MR_RCM" class="bunch" style="display: none;">
		    <button id="85_IPSL-CM5A-MR_HIRHAM5" class="selected" onclick="selectButton(this)">
			<span>HIRHAM5</span>
		    </button>
		    <button id="85_IPSL-CM5A-MR_RCA4" onclick="selectButton(this)">
			<span>RCA4</span>
		    </button>
		    <button id="85_IPSL-CM5A-MR_WRF381P" onclick="selectButton(this)">
			<span>WRF381P</span>
		    </button>
		</div>

		<!-- MPI-ESM-LR -->
		<div id="bunch_26_MPI-ESM-LR_RCM" class="bunch" style="display: none;">
		    <button id="26_MPI-ESM-LR_CCLM4-8-17" onclick="selectButton(this)">
			<span>CCLM4-8-17</span>
		    </button>
		    <button id="26_MPI-ESM-LR_RegCM4-6" onclick="selectButton(this)">
			<span>RegCM4-6</span>
		    </button>
		    <button id="26_MPI-ESM-LR_REMO" onclick="selectButton(this)">
			<span>REMO</span>
		    </button>
		</div>
		<div id="bunch_45_MPI-ESM-LR_RCM" class="bunch" style="display: none;">
		    <button id="45_MPI-ESM-LR_CCLM4-8-17" onclick="selectButton(this)">
			<span>CCLM4-8-17</span>
		    </button>
		    <button id="45_MPI-ESM-LR_REMO" onclick="selectButton(this)">
			<span>REMO</span>
		    </button>
		</div>
		<div id="bunch_85_MPI-ESM-LR_RCM" class="bunch" style="display: none;">
		    <button id="85_MPI-ESM-LR_CCLM4-8-17" onclick="selectButton(this)">
			<span>CCLM4-8-17</span>
		    </button>
		    <button id="85_MPI-ESM-LR_RegCM4-6" onclick="selectButton(this)">
			<span>RegCM4-6</span>
		    </button>
		    <button id="85_MPI-ESM-LR_REMO" onclick="selectButton(this)">
			<span>REMO</span>
		    </button>
		</div>

		<!-- NorESM1-M -->
		<div id="bunch_26_NorESM1-M_RCM" class="bunch" style="display: none;">
		    <button id="26_NorESM1-M_REMO" onclick="selectButton(this)">
			<span>REMO</span>
		    </button>
		</div>
		<div id="bunch_45_NorESM1-M_RCM" class="bunch" style="display: none;">
		    <button id="45_NorESM1-M_HIRHAM5" onclick="selectButton(this)">
			<span>HIRHAM5</span>
		    </button>
		    <button id="45_NorESM1-M_REMO" onclick="selectButton(this)">
			<span>REMO</span>
		    </button>
		</div>
		<div id="bunch_85_NorESM1-M_RCM" class="bunch" style="display: none;">
		    <button id="85_NorESM1-M_HIRHAM5" onclick="selectButton(this)">
			<span>HIRHAM5</span>
		    </button>
		    <button id="85_NorESM1-M_REMO" onclick="selectButton(this)">
			<span>REMO</span>
		    </button>
		    <button id="85_NorESM1-M_WRF381P" onclick="selectButton(this)">
			<span>WRF381P</span>
		    </button>
		</div>


		<p class="menu_section">Correction de Biais</p>
		<div id="bunch_BC" class="bunch" style="display: block;">
		    <button id="ADAMONT_Model" class="selected" onclick="selectButton(this); show_Model(this);">
			<span>ADAMONT</span>
		    </button>
		    <button id="CDFt_Model" onclick="selectButton(this); show_Model(this);">
			<span>CDFt</span>
		    </button>
		</div>
		
		<p class="menu_section">Modèle Hydrologique</p>
		<div id="bunch_ADAMONT_Model" class="bunch" style="display: block;">
		    <button id="ADAMONT_CTRIP" class="CTRIP" onclick="selectButton(this)">
			<span>CTRIP</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_EROS" class="EROS" onclick="selectButton(this)">
			<span>EROS</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_GRSD" class="GRSD" onclick="selectButton(this)">
			<span>GRSD</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_J2000" class="J2000 selected" onclick="selectButton(this)">
			<span>J2000</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_MORDOR-SD" class="MORDOR-SD" onclick="selectButton(this)">
			<span>MORDOR-SD</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_MORDOR-TS" class="MORDOR-TS" onclick="selectButton(this)">
			<span>MORDOR-TS</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_ORCHIDEE" class="ORCHIDEE" onclick="selectButton(this)">
			<span>ORCHIDEE</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_SIM2" class="SIM2" onclick="selectButton(this)">
			<span>SIM2</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_SMASH" class="SMASH" onclick="selectButton(this)">
			<span>SMASH</span>
			<span class="notif"></span>
		    </button>
		</div>
		<div id="bunch_CDFt_Model" class="bunch" style="display: none;">
		    <button id="ADAMONT_EROS" class="EROS" onclick="selectButton(this)">
			<span>EROS</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_GRSD" class="GRSD" onclick="selectButton(this)">
			<span>GRSD</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_J2000" class="J2000 selected" onclick="selectButton(this)">
			<span>J2000</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_MORDOR-SD" class="MORDOR-SD" onclick="selectButton(this)">
			<span>MORDOR-SD</span>
			<span class="notif"></span>
		    </button>
		    <button id="ADAMONT_SMASH" class="SMASH" onclick="selectButton(this)">
			<span>SMASH</span>
			<span class="notif"></span>
		    </button>
		</div>


            </div>
        </div>


	<div id="back_bar_map_gallery">
	    
	    <div id="back_bar">
		<div id="bar">
		    <div id="gallery-bar">
			
			<div class="gallery-bar-item">
			    <button id="crue" class="button_bar">
				<span>Quel avenir pour les crues dans un futur lointain ?</span>
			    </button>
			</div>
			
			<div class="gallery-bar-item">
			    <button id="hiver" class="button_bar">
				<span>À quoi pourrait ressembler nos hivers d'ici 10 ans ?</span>
			    </button>
			</div>
			
			<div class="gallery-bar-item">
			    <button id="ete" class="button_bar">
				<span>À quoi pourrait ressembler nos étés d'ici 2070 ?</span>
			    </button>
			</div>
			
			<div class="gallery-bar-item">
			    <button id="prediction" class="button_bar">
				<span>Peut-on prédire le futur ?</span>
			    </button>
			</div>
			
			<div class="gallery-bar-item">
			    <button id="GCM" class="button_bar">
				<span>C'est quoi un modèle climatique ?</span>
			    </button>
			</div>

		    </div>
		</div> 	
	    </div> 

	    <div id="back_map_gallery">
		
		<div id="map-container">
		    <svg id="geoJSONsvg_france"></svg>
		</div>

		<div class="gallery">
		    <div class="gallery-item horizontal">
			<span>1</span>
		    </div>
		    <div class="gallery-item">
			<span>2</span>
		    </div>
		    <div class="gallery-item vertical">
			<span>3</span>
		    </div>
		    <div class="gallery-item">
			<span>4</span>
		    </div>
		    <div class="gallery-item horizontal">
			<span>5</span>
		    </div>
		    <div class="gallery-item vertical horizontal ">
			<span>6</span>
		    </div>
		    <div class="gallery-item">
			<span>7</span>
		    </div>
		    <div class="gallery-item horizontal vertical">
			<span>8</span>
		    </div>
		    <div class="gallery-item vertical">
			<span>9</span>
		    </div>
		    <div class="gallery-item">
			<span>10</span>
		    </div>
		</div>

	    </div>
	</div>
	
	<script>



	 /* const CTRIP_lightcolor = "#f6f4f1";
	    const CTRIP_color = "#A88D72";
	    const EROS_lightcolor = "#fafaf4";
	    const EROS_color = "#CECD8D";
	    const GRSD_lightcolor = "#eff5f0";
	    const GRSD_color = "#619C6C";
	    const J2000_lightcolor = "#ddfeff";
	    const J2000_color = "#00a3a6";
	    const MORDOR-SD_lightcolor = "#fbf1ed";
	    const MORDOR-SD_color = "#D8714E";
	    const MORDOR-TS_lightcolor = "#f8eceb";
	    const MORDOR-TS_color = "#AE473E";
	    const ORCHIDEE_lightcolor = "#fdf6f5";
	    const ORCHIDEE_color = "#EFA59D";
	    const SIM2_lightcolor = "#ebeff2";
	    const SIM2_color = "#475E6A";
	    const SMASH_lightcolor = "#fef8ef";
	    const SMASH_color = "#F6BA62"; */




	 
	 function selectButton(selectedButton) {
	     var buttons = selectedButton.parentNode.querySelectorAll('button');
	     buttons.forEach(function (button) {
		 button.classList.remove('selected');
	     });
	     selectedButton.classList.add('selected');
	 }

	 function show_GCM_RCM(selectedButton) {
	     var RCP = selectedButton.id.split('_')[0];
	     var GCM = selectedButton.id.split('_')[1];
	     var RCM = selectedButton.id.split('_')[2];
	     
	     if (GCM === "GCM") {
		 var GCM_bunchAll = document.querySelectorAll(`[id^="bunch_"][id$="_GCM"]`);
		 GCM_bunchAll.forEach(function (GCM_bunch) {
		     GCM_bunch.style.display = 'none';
		 });
		 var GCM_bunch_selected = document.getElementById(`bunch_${RCP}_GCM`);
		 if (GCM_bunch_selected) {
		     GCM_bunch_selected.style.display = 'block';
		 }
		 var GCM_buttonSelected = GCM_bunch_selected.querySelector('.selected');
		 var GCM_selected = GCM_buttonSelected ? GCM_buttonSelected.id.split('_')[1] : null;
	     }
	     if (GCM === "GCM" || RCM === "RCM") {
		 var RCM_bunchAll = document.querySelectorAll(`[id^="bunch_"][id$="_RCM"]`);
		 RCM_bunchAll.forEach(function (RCM_bunch) {
		     RCM_bunch.style.display = 'none';
		 });
		 if (GCM_selected) {
		     var RCM_bunch_selected = document.getElementById(`bunch_${RCP}_${GCM_selected}_RCM`);
		 } else {
		     var RCM_bunch_selected = document.getElementById(`bunch_${RCP}_${GCM}_RCM`);
		 }
		 if (RCM_bunch_selected) {
		     RCM_bunch_selected.style.display = 'block';
		 }
	     }
	 }
	 

	 function show_Model(selectedButton) {
	     var BC = selectedButton.id.split('_')[0];
	     var Model = selectedButton.id.split('_')[1];
	     
	     if (Model === "Model") {
		 var Model_bunchAll = document.querySelectorAll(`[id^="bunch_"][id$="_Model"]`);
		 Model_bunchAll.forEach(function (Model_bunch) {
		     Model_bunch.style.display = 'none';
		 });
		 var Model_bunch_selected = document.getElementById(`bunch_${BC}_Model`);
		 if (Model_bunch_selected) {
		     Model_bunch_selected.style.display = 'block';
		 }
	     }
	 }




	 

	 function toggleMenu() {
	     const menu = document.getElementById("menu");
	     const menuExpand = document.getElementById("menuExpand");

	     if (menu.classList.contains("expanded")) {
		 menu.classList.remove("expanded");
		 menuExpand.classList.add("hidden");
	     } else {
		 menu.classList.add("expanded");
		 menuExpand.classList.remove("hidden");
	     }
	 }

	 

	 const geoJSONfiles = [
	     "data/france.geo.json",
	     "data/river.geo.json",
	     "data/entiteHydro.geo.json"
	 ];

	 function loadGeoJSON(fileURL) {
	     return d3.json(fileURL)
		      .then(data => data)
		      .catch(error => {
			  console.error("Error loading geojson file :", error);
			  throw error;
		      });
	 }

	 const promises = geoJSONfiles.map(fileURL => loadGeoJSON(fileURL));

	 Promise.all(promises)
		.then(geoJSONdata => {
		    const geoJSONdata_france = geoJSONdata[0];
		    const geoJSONdata_river = geoJSONdata[1];
		    const geoJSONdata_entiteHydro = geoJSONdata[2];
		    drawGeoJSON(geoJSONdata_france, geoJSONdata_river, geoJSONdata_entiteHydro);
		})
		.catch(error => {
		    console.error("Error loading or processing GeoJSON files:", error);
		});

	 

	 function drawGeoJSON(geoJSONdata_france, geoJSONdata_river, geoJSONdata_entiteHydro) {
	     if (geoJSONdata_france && geoJSONdata_river) {

		 const fill_entiteHydro = "transparent";
		 const stroke_entiteHydro = "#000000";
		 
		 const fill_france = "transparent";
		 const stroke_france = "#89898A";
		 /* "#3D3E3E"; */
		 const stroke_river = "#B0D9D6";

		 const minZoom = 1;
		 const maxZoom = 4;
		 const maxPan = 0;

		 const transitionDuration = 500;
		 
		 const k_simplify_ref = 0.1;
		 let k_simplify = k_simplify_ref;

		 const riverLength_max = 0.4;
		 const riverLength_min = 0;
		 let riverLength = riverLength_max;

		 const strokeWith_france = 2;
		 const strokeWith_river_max = 1.5;
		 const strokeWith_river_min = 0.4;
		 
		 let width = window.innerHeight;
		 let height = window.innerHeight;
		 

		 const zoom = d3.zoom()
				.scaleExtent([minZoom, maxZoom])
				.on("zoom", function (event) { 
				    riverLength = riverLength_max - (event.transform.k - minZoom)/(maxZoom-minZoom)*(riverLength_max-riverLength_min);
				    k_simplify = k_simplify_ref + (event.transform.k - minZoom)/(maxZoom-minZoom)*(1-k_simplify_ref);

				    redrawMap();
				    
				    svg.attr("transform", event.transform);
				    svg.style("width", width * event.transform.k + "px");
				    svg.style("height", height * event.transform.k + "px");
				});


		 const projection = d3.geoMercator()
				      .center(geoJSONdata_france.features[0].properties.centroid);
		 
		 const svg = d3.select("#geoJSONsvg_france")
			       .attr("width", "100%")
			       .attr("height", "100%")
			       .call(zoom)
			       .append("g");

		 

		 function handleResize() {
		     if (window.innerWidth < window.innerHeight) {
			 var width = window.innerWidth;
			 var height = window.innerWidth;
		     } else {
			 var width = window.innerHeight;
			 var height = window.innerHeight;
		     }
		     zoom.translateExtent([[-width*maxPan, -height*maxPan], [width*(1+maxPan), height*(1+maxPan)]]);
		     svg.attr("width", width).attr("height", height);
		     projection.scale([height*3.2]).translate([width / 2, height / 2]);
		     redrawMap();
		 }

		 window.addEventListener("resize", handleResize.bind(null, k_simplify, riverLength));


		 
		 function redrawMap() {
		     const simplifiedGeoJSON_france = geotoolbox.simplify(geoJSONdata_france, { k: k_simplify, merge: false });
		     const selectedGeoJSON_river = geotoolbox.filter(geoJSONdata_river, (d) => d.norm >= riverLength);
		     const simplifiedselectedGeoJSON_river = geotoolbox.simplify(selectedGeoJSON_river, { k: k_simplify, merge: false });
		     
		     svg.selectAll("path.france")
			.data(simplifiedGeoJSON_france.features)
			.join("path")
			.attr("class", "france")
			.attr("d", pathGenerator)
			.transition()
			.duration(1000)
			.attr("fill", fill_france)
			.attr("stroke", stroke_france)
			.attr("stroke-width", strokeWith_france)
			.attr("stroke-linejoin", "miter")
			.attr("stroke-miterlimit", 1);

		     svg.selectAll("path.river")
			.data(simplifiedselectedGeoJSON_river.features)
			.join("path")
			.attr("class", "river")
			.attr("d", pathGenerator)
			.transition()
			.duration(1000)
			.attr("fill", "transparent")
			.attr("stroke", stroke_river)
			.attr("stroke-width", function(d) {
			    return strokeWith_river_max - (1 - d.properties.norm) * (strokeWith_river_max - strokeWith_river_min);
			})
			.attr("stroke-linejoin", "miter")
			.attr("stroke-linecap", "round")
			.attr("stroke-miterlimit", 1);
		 }



		 const pathGenerator = d3.geoPath(projection);

		 redrawMap();
		 handleResize();
		 

		 return svg.node();
	     }
	 }





	 

	 


	 var rangeSlider_reference = document.getElementById('period_reference');
	 noUiSlider.create(rangeSlider_reference, {
	     start: [1970, 2000],
	     margin: 30,
	     behaviour: 'drag-smooth-steps-tap',
	     step: 5,
	     connect: true,
	     keyboardDefaultStep: 1,
	     keyboardPageMultiplier: 2,
	     keyboardMultiplier: 1,
	     tooltips: [wNumb({decimals: 0}), wNumb({decimals: 0})],
	     format: {
		 from: function(value) {
		     return parseInt(value);
		 },
		 to: function(value) {
		     return parseInt(value);
		 }
	     },
	     range: {
		 'min': 1970,
		 'max': 2020
	     },
	     pips: {
		 mode: 'values',
		 values: [1970, 2000, 2020],
		 density: 10,
		 format: wNumb({
		     decimals: 0,
		 })
	     }
	     
	 });
	 mergeTooltips(rangeSlider_reference, 100, ' - ');


	 var rangeSlider_futur = document.getElementById('period_futur');
	 noUiSlider.create(rangeSlider_futur, {
	     start: [2040, 2070],
	     margin: 30,
	     behaviour: 'drag-smooth-steps-tap',
	     step: 5,
	     connect: true,
	     keyboardDefaultStep: 1,
	     keyboardPageMultiplier: 2,
	     keyboardMultiplier: 1,
	     tooltips: [wNumb({decimals: 0}), wNumb({decimals: 0})],
	     format: {
		 from: function(value) {
		     return parseInt(value);
		 },
		 to: function(value) {
		     return parseInt(value);
		 }
	     },
	     range: {
		 'min': 2020,
		 'max': 2100
	     },
	     pips: {
		 mode: 'values',
		 values: [2020, 2050, 2100],
		 density: 10,
		 format: wNumb({
		     decimals: 0,
		 })
	     }
	     
	 });
	 mergeTooltips(rangeSlider_futur, 100, ' - ');


	 

	 /**
	  * @param slider HtmlElement with an initialized slider
	  * @param threshold Minimum proximity (in percentages) to merge tooltips
	  * @param separator String joining tooltips
	  */
	 function mergeTooltips(slider, threshold, separator) {
	     var textIsRtl = getComputedStyle(slider).direction === 'rtl';
	     var isRtl = slider.noUiSlider.options.direction === 'rtl';
	     var isVertical = slider.noUiSlider.options.orientation === 'vertical';
	     var tooltips = slider.noUiSlider.getTooltips();
	     var origins = slider.noUiSlider.getOrigins();
	     var arrows = [];
	     tooltips.forEach(function (tooltip, index) {
		 if (tooltip) {
		     let div = document.createElement('div');
		     div.classList.add('noUi-tooltip-arrow');
		     origins[index].appendChild(div);
		     origins[index].appendChild(tooltip);
		     arrows.push(div);
		 }
	     });
	     
	     slider.noUiSlider.on('update', function (values, handle, unencoded, tap, positions) {
		 
		 var pools = [[]];
		 var poolPositions = [[]];
		 var poolValues = [[]];
		 var atPool = 0;

		 // Assign the first tooltip to the first pool, if the tooltip is configured
		 if (tooltips[0]) {
		     pools[0][0] = 0;
		     poolPositions[0][0] = positions[0];
		     poolValues[0][0] = values[0];
		 }

		 for (var i = 1; i < positions.length; i++) {
		     if (!tooltips[i] || (positions[i] - positions[i - 1]) > threshold) {
			 atPool++;
			 pools[atPool] = [];
			 poolValues[atPool] = [];
			 poolPositions[atPool] = [];
		     }

		     if (tooltips[i]) {
			 pools[atPool].push(i);
			 poolValues[atPool].push(values[i]);
			 poolPositions[atPool].push(positions[i]);
		     }
		 }

		 pools.forEach(function (pool, poolIndex) {
		     var handlesInPool = pool.length;

		     for (var j = 0; j < handlesInPool; j++) {
			 var handleNumber = pool[j];

			 if (j === handlesInPool - 1) {
			     var offset = 0;

			     poolPositions[poolIndex].forEach(function (value) {
				 offset += 1000 - value;
			     });

			     var direction = isVertical ? 'bottom' : 'right';
			     var last = isRtl ? 0 : handlesInPool - 1;
			     var lastOffset = 1000 - poolPositions[poolIndex][last];
			     offset = (textIsRtl && !isVertical ? 100 : 0) + (offset / handlesInPool) - lastOffset;
			     
			     // Center this tooltip over the affected handles
			     tooltips[handleNumber].innerHTML = poolValues[poolIndex].join(separator);
			     tooltips[handleNumber].style.display = 'block';
			     tooltips[handleNumber].style[direction] = offset + '%';

			     arrows[handleNumber].style.display = 'block';
			     arrows[handleNumber].style[direction] = offset + '%';
			     
			 } else {
			     // Hide this tooltip
			     tooltips[handleNumber].style.display = 'none';
			     arrows[handleNumber].style.display = 'none';
			 }
		     }
		 });
	     });
	 }



	 
	</script>
    </body>
</html>
